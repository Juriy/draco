{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap b7b2b76971cc2ac3f919","webpack:///./src/index.js","webpack:///./src/Animator.js","webpack:///./src/DirtyRectangleManager.js","webpack:///./src/Rect.js","webpack:///./src/Engine.js","webpack:///./src/input/Keyboard.js","webpack:///./src/EventEmitter.js","webpack:///./src/input/TouchInputHandler.js","webpack:///./src/input/InputHandlerBase.js","webpack:///./src/input/MouseInputHandler.js","webpack:///./src/ImageManager.js","webpack:///./src/utils.js","webpack:///./src/GameObject.js","webpack:///./src/GameScene.js","webpack:///./src/MathUtils.js","webpack:///./src/ui/index.js","webpack:///./src/ui/Rectangle.js","webpack:///./src/ui/Shapes.js","webpack:///./src/ui/Sprite.js","webpack:///./src/ui/SpriteSheet.js","webpack:///./src/ui/TileSheet.js","webpack:///./src/ui/map/TileMapOrtho.js"],"names":[],"mappings":"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","file":"draco.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"draco\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"draco\"] = factory();\n\telse\n\t\troot[\"draco\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap b7b2b76971cc2ac3f919\n **/","'use strict';\n\nimport Animator from './Animator';\nimport DirtyRectangleManager from './DirtyRectangleManager';\nimport Engine from './Engine';\nimport EventEmitter from './EventEmitter';\nimport GameObject from './GameObject';\nimport GameScene from './GameScene';\nimport ImageManager from './ImageManager';\nimport MathUtils from './MathUtils';\nimport Rect from './Rect';\nimport {isTouchDevice, dist} from './utils';\nimport * as ui from './ui/index';\n\nexport {Animator, DirtyRectangleManager, Engine, EventEmitter, GameObject,\n\tGameScene, ImageManager, MathUtils, Rect, isTouchDevice, dist, ui};\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/index.js\n **/","'use strict';\r\n\r\n/**\r\n * This is the base class to support the animation.\r\n * @param duration - the duration of the one loop of the animation in milliseconds.\r\n * For example, for a 6-frame animation where each frame is staying on the\r\n * screen for 50 milliseconds the duration will be 300 milliseconds.\r\n *\r\n * The constructor accepts the bare minimum of parameters: the rest is set via setters:\r\n * setRepeatBehavior and setRepeatCount (see the function docs for the details)\r\n *\r\n * Animator doesn't handle the timing internally. It should be used with the external\r\n * timer. The external timer calls the update() function, passing the number of milliseconds\r\n * since the previous call as the parameter.\r\n */\r\nexport default class Animator {\r\n\tconstructor(duration) {\r\n\t\tthis._duration = duration;\r\n\r\n\t\t// total loops to do\r\n\t\tthis._repeatCount = 1;\r\n\r\n\t\t// the fraction to accelerate\r\n\t\tthis._acceleration = 0;\r\n\r\n\t\t// the fraction to decelerate\r\n\t\tthis._deceleration = 0;\r\n\r\n\t\t// How many loops were actually done\r\n\t\tthis._loopsDone = 0;\r\n\r\n\t\t// Default repeat behavior is LOOP\r\n\t\tthis._repeatBehavior = Animator.RepeatBehavior.LOOP;\r\n\r\n\t\t// Time, passed since the start of the loop\r\n\t\tthis._timeSinceLoopStart = 0;\r\n\r\n\t\t// This flag is used to indicate that the animator has already\r\n\t\t// started to work with the certain configuration of parameters (repeatCount, repeat\r\n\t\tthis._started = false;\r\n\t\tthis._running = false;\r\n\r\n\t\t// Flag to mark that this loop is going into the opposite direction\r\n\t\tthis._reverseLoop = false;\r\n\t}\r\n\r\n\t/**\r\n\t * Starts the animator. After the animator is started you can't\r\n\t * change its parameters until stop() is called.\r\n\t */\r\n\tstart() {\r\n\t\tthis._started = true;\r\n\t\tthis._running = true;\r\n\t}\r\n\r\n\t/**\r\n\t * Checks if animator is currently running\r\n\t */\r\n\tisRunning() {\r\n\t\treturn this._running;\r\n\t}\r\n\r\n\t/**\r\n\t * Stops the animator and resets the internal state. This function\r\n\t * may be called multiple times.\r\n\t */\r\n\tstop() {\r\n\t\tthis._loopsDone = 0;\r\n\t\tthis._timeSinceLoopStart = 0;\r\n\t\tthis._running = false;\r\n\t\tthis._started = false;\r\n\t};\r\n\r\n\t/**\r\n\t * Pauses the animator. The animator will ignore the updates while paused, \"freezing\"\r\n\t * the animation but not resetting its state. The animation can be then resumed\r\n\t */\r\n\tpause() {\r\n\t\tthis._running = false;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the duration of one loop of the animation\r\n\t */\r\n\tgetDuration() {\r\n\t\treturn this._duration;\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the duration of one loop of the animation. Should be value >=1\r\n\t */\r\n\tsetDuration(duration) {\r\n\t\tthis._throwIfStarted();\r\n\t\tif (duration < 1) {\r\n\t\t\tthrow Error('Duration can\\'t be < 1');\r\n\t\t}\r\n\t\tthis._duration = duration;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the configured repeat count, default is 1.\r\n\t */\r\n\tgetRepeatCount() {\r\n\t\treturn this._repeatCount;\r\n\t}\r\n\r\n\t/**\r\n\t * Set the number of loops in the animation, default is 1. Valid values\r\n\t * are integers, -1 or Animator.INFINITE for infinite looping\r\n\t */\r\n\tsetRepeatCount(repeatCount) {\r\n\t\tthis._throwIfStarted();\r\n\r\n\t\tif (repeatCount < 1 && repeatCount !== Animator.INFINITE) {\r\n\t\t\tthrow Error('Repeat count must be greater than 0 or INFINITE');\r\n\t\t}\r\n\t\tthis._repeatCount = repeatCount;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the configured repeat behavior of the animator. Possible values are\r\n\t * Animator.RepeatBehavior.LOOP and Animator.RepeatBehavior.REPATE. Read the docs for\r\n\t * Animator.RepeatBehavior for the details on how they differ.\r\n\t */\r\n\tgetRepeatBehavior() {\r\n\t\treturn this._repeatBehavior;\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the repeat behavior, default value is Animator.RepeatBehavior.LOOP\r\n\t * @param behavior the new repat behavior\r\n\t */\r\n\tsetRepeatBehavior(behavior) {\r\n\t\tthis._throwIfStarted();\r\n\t\tif (behavior !== Animator.RepeatBehavior.LOOP &&\r\n\t\t\t\tbehavior !== Animator.RepeatBehavior.REVERSE) {\r\n\t\t\tthrow Error('Repeat behavior should be either RepeatBehavior.LOOP' +\r\n\t\t\t\t' or RepeatBehavior.REVERSE');\r\n\t\t}\r\n\t\tthis._repeatBehavior = behavior;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the current value for the acceleration, default is 0.\r\n\t */\r\n\tgetAcceleration() {\r\n\t\treturn this._acceleration;\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the value for the acceleration. The value must be between 0 and 1-deceleration.\r\n\t * @param acceleration new acceleration\r\n\t */\r\n\tsetAcceleration(acceleration) {\r\n\t\tthis._throwIfStarted();\r\n\t\tif (acceleration < 0 || acceleration > 1 || acceleration > (1 - this._deceleration)) {\r\n\t\t\tthrow Error('Acceleration value must be from 0 to 1 and ' +\r\n\t\t\t\t'cannot be greater than (1 - deceleration)');\r\n\t\t}\r\n\r\n\t\tthis._acceleration = acceleration;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the current value for the deceleration, default is 0.\r\n\t */\r\n\tgetDeceleration() {\r\n\t\treturn this._deceleration;\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the value for the deceleraion. The value must be between 0 and 1-deceleration.\r\n\t * @param deceleration new deceleration\r\n\t */\r\n\tsetDeceleration(deceleration) {\r\n\t\tthis._throwIfStarted();\r\n\t\tif (deceleration < 0 || deceleration > 1 || deceleration > (1 - this._acceleration)) {\r\n\t\t\tthrow Error('Deceleration value must be from 0 to 1 ' +\r\n\t\t\t\t'and cannot be greater than (1 - acceleration)');\r\n\t\t}\r\n\r\n\t\tthis._deceleration = deceleration;\r\n\t}\r\n\r\n\t/**\r\n\t * In the default implementation the preprocessor takes into the account\r\n\t * only acceleration and deceleration. In more advanced implementation it might\r\n\t * use easing functions or any other more advanced transformations.\r\n\t */\r\n\t_timingEventPreprocessor(fraction) {\r\n\t\treturn this._accelerationDecelerationPreprocessor(fraction);\r\n\t}\r\n\r\n\t/**\r\n\t * Calculates the fraction with the respect to the acceleration and deceleration values.\r\n\t * See the SMIL 2.0 specification for details on this calculation. You shouldn't really dive deep\r\n\t * into the details of this particular piece of code, if you're not very curious.\r\n\t */\r\n\t_accelerationDecelerationPreprocessor(fraction) {\r\n\t\tif (this._acceleration || this._deceleration) {\r\n\t\t\tlet runRate = 1 / (1 - this._acceleration / 2 - this._deceleration / 2);\r\n\r\n\t\t\tif (fraction < this._acceleration) {\r\n\t\t\t\tfraction *= runRate * (fraction / this._acceleration) / 2;\r\n\t\t\t} else if (fraction > (1 - this._deceleration)) {\r\n\t\t\t\t// time spent in deceleration portion\r\n\t\t\t\tlet tdec = fraction - (1 - this._deceleration);\r\n\t\t\t\t// proportion of tdec to total deceleration time\r\n\t\t\t\tlet pdec = tdec / this._deceleration;\r\n\r\n\t\t\t\tfraction = runRate * (1 - (this._acceleration / 2) -\r\n\t\t\t\t\tthis._deceleration + tdec * (2 - pdec) / 2);\r\n\t\t\t} else {\r\n\t\t\t\tfraction = runRate * (fraction - (this._acceleration / 2));\r\n\t\t\t}\r\n\t\t\t// clamp fraction to [0,1] since above calculations may\r\n\t\t\t// cause rounding errors\r\n\t\t\tif (fraction < 0) {\r\n\t\t\t\tfraction = 0;\r\n\t\t\t} else if (fraction > 1) {\r\n\t\t\t\tfraction = 1;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn fraction;\r\n\t}\r\n\r\n\t/**\r\n\t * This function should be called by the external timer to update the state\r\n\t * of the animator.\r\n\t * @param deltaTime - time passed since the last upate. 0 is valid value.\r\n\t */\r\n\tupdate(deltaTime) {\r\n\t\t// Will return undefined\r\n\t\tif (!this._started) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// If the animator is paused we pass 0 as deltaTime - like nothing has changed\r\n\t\tif (!this._running) {\r\n\t\t\tdeltaTime = 0;\r\n\t\t}\r\n\r\n\t\tthis._timeSinceLoopStart += deltaTime;\r\n\r\n\t\t// If we exceeded the loop time, we must take care of what to do next:\r\n\t\t// adjust the direction of the animation, call hook functions etc.\r\n\t\tif (this._timeSinceLoopStart >= this._duration) {\r\n\r\n\t\t\t// Just in case, we skipped more than one loop, determine how many loops did we miss\r\n\t\t\tlet loopsSkipped = Math.floor(this._timeSinceLoopStart / this._duration);\r\n\r\n\t\t\tthis._timeSinceLoopStart %= this._duration;\r\n\r\n\t\t\t// truncate to the number of loops skipped. Even if we skipped 5 loops,\r\n\t\t\t// but there was only 3 left, we don't want to fire extra listeners.\r\n\t\t\tif (this._repeatCount !== Animator.INFINITE && loopsSkipped >\r\n\t\t\t\t\tthis._repeatCount - this._loopsDone) {\r\n\t\t\t\tloopsSkipped = this._repeatCount - this._loopsDone;\r\n\t\t\t}\r\n\r\n\t\t\t// Call the hook for each of the skipped loops\r\n\t\t\tfor (let i = 1; i <= loopsSkipped; i++) {\r\n\t\t\t\tthis._loopsDone++;\r\n\t\t\t\tthis._reverseLoop = this._repeatBehavior === Animator.RepeatBehavior.REVERSE &&\r\n\t\t\t\t\tthis._loopsDone % 2 === 1;\r\n\t\t\t\tthis._onLoopEnd(this._loopsDone);\r\n\t\t\t}\r\n\r\n\t\t\t// Check if we reached the end of the animation\r\n\t\t\tif (this._repeatCount !== Animator.INFINITE &&\r\n\t\t\t\t\tthis._loopsDone === this._repeatCount) {\r\n\t\t\t\tthis._onAnimationEnd();\r\n\t\t\t\tthis.stop();\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// If this is the loop that is going backwards - reverse the fraction as well\r\n\t\tlet fraction = this._timeSinceLoopStart / this._duration;\r\n\r\n\t\tif (this._reverseLoop) {\r\n\t\t\tfraction = 1 - fraction;\r\n\t\t}\r\n\r\n\t\t// Give away for preprocessing (acceleration/deceleration, easing functions etc)\r\n\t\tfraction = this._timingEventPreprocessor(fraction);\r\n\r\n\t\t// Call update\r\n\t\tthis._onUpdate(fraction, this._loopsDone);\r\n\t\treturn fraction;\r\n\t}\r\n\r\n\t/**\r\n\t * Hook function. Override in subclass to provide the specific\r\n\t * implementation of the updates. For example, you may change the\r\n\t * active frame, adjust the coordinates or color of the object.\r\n\t *\r\n\t * @param fraction the current fraction of the animation: from 0 to 1\r\n\t * @param loopsDone how many loops done already.\r\n\t */\r\n\t_onUpdate(fraction, loopsDone) {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Hook function - called when the loop ends. Should be owerwritten in\r\n\t * subclasses if you need any extra functionality here.\r\n\t * @param loopsDone the number of loops done from the start of the animation,\r\n\t * the latest loop is included.\r\n\t */\r\n\t_onLoopEnd(loopsDone) {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Hook function - called when the animation ends to be owerwritten in\r\n\t * subclasses if you need any extra functionality here.\r\n\t */\r\n\t_onAnimationEnd() {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * This function is called to ensure that the animator is not running\r\n\t * (changing the setting of the running animator is not allowed)\r\n\t */\r\n\t_throwIfStarted() {\r\n\t\tif (this._started) {\r\n\t\t\tthrow Error('Cannot change property on the started animator');\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * A possible parameter to setLoopCount.\r\n */\r\nAnimator.INFINITE = -1;\r\n\r\n/**\r\n * RepeatBehavior determines what animator does after reaching the end of the loop.\r\n * If it is set to Animator.RepeatBehavior.LOOP, then the next loop will start from 0 again,\r\n * proceeding to 1. If the behavior is Animator.RepeatBehavior.REVERSE the odd loops will run\r\n * backwards - from 1 to 0. Obviously setting this parameter only makes sense when the\r\n * number of loops is more than 1.\r\n */\r\nAnimator.RepeatBehavior = {\r\n\tLOOP: 1,\r\n\tREVERSE: 2\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/Animator.js\n **/","'use strict';\n\nimport Rect from './Rect';\n\nexport default class DirtyRectangleManager {\n\n\tconstructor(allDirtyThreshold = 0.5) {\n\t\tthis._allDirtyThreshold = allDirtyThreshold;\n\t\tthis._viewport = new Rect(0, 0, 100, 100);\n\t\tthis._dirtyRect = null;\n\t\tthis._allDirty = true;\n\t\tthis.markAllDirty();\n\t}\n\n\tclear() {\n\t\tthis._dirtyRect = null;\n\t\tthis._allDirty = false;\n\t}\n\n\tmarkDirty(rect) {\n\t\tif (!(rect.width || rect.height) || this._allDirty) {\n\t\t\treturn;\n\t\t}\n\n\t\trect = this._viewport.intersection(rect);\n\n\t\tif (!rect) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._dirtyRect) {\n\t\t\tthis._dirtyRect = this._dirtyRect.convexHull(rect);\n\t\t\tif (this._dirtyRect.width * this._dirtyRect.height >\n\t\t\t\tthis._allDirtyThreshold * this._viewport.width * this._viewport.height) {\n\t\t\t\tthis.markAllDirty();\n\t\t\t}\n\t\t} else {\n\t\t\tthis._dirtyRect = this._viewport.intersection(rect);\n\t\t}\n\t}\n\n\tmarkAllDirty() {\n\t\tthis._allDirty = true;\n\t\tthis._dirtyRect = this._viewport.copy();\n\t}\n\n\tisClean() {\n\t\treturn !(this._dirtyRect);\n\t}\n\n\tisAllDirty() {\n\t\treturn this._allDirty;\n\t}\n\n\tgetDirtyRect() {\n\t\treturn this._dirtyRect;\n\t}\n\n\tsetViewport(width, height) {\n\t\tif (this._viewport.width === width && this._viewport.height === height) {\n\t\t\treturn;\n\t\t}\n\t\tthis._viewport.width = width;\n\t\tthis._viewport.height = height;\n\t\tthis.markAllDirty();\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/DirtyRectangleManager.js\n **/","'use strict';\r\n\r\n/**\r\n * TODO: refactor-out object destructuring\r\n */\r\nexport default class Rect {\r\n\r\n\tconstructor(x, y, width, height) {\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t\tthis.width = width;\r\n\t\tthis.height = height;\r\n\t}\r\n\r\n\tcopy() {\r\n\t\treturn new Rect(this.x, this.y, this.width, this.height);\r\n\t}\r\n\r\n\tequals(r2) {\r\n\t\treturn (this.x === r2.x &&\r\n\t\tthis.y === r2.y &&\r\n\t\tthis.width === r2.width &&\r\n\t\tthis.height === r2.height);\r\n\t}\r\n\r\n\ttoString() {\r\n\t\treturn (`[x=${this.x}, y=${this.y},` +\r\n\t\t\t`width=${this.width}, height=${this.height}]`);\r\n\t}\r\n\r\n\tintersects(x2, y2, w2, h2) {\r\n\t\tif (arguments.length === 1) {\r\n\t\t\tlet r = x2;\r\n\r\n\t\t\tx2 = r.x;\r\n\t\t\ty2 = r.y;\r\n\t\t\tw2 = r.width;\r\n\t\t\th2 = r.height;\r\n\t\t}\r\n\r\n\t\treturn (this.x <= x2 + w2 && this.x + this.width >= x2 &&\r\n\t\t\tthis.y <= y2 + h2 && this.y + this.height >= y2);\r\n\t}\r\n\r\n\t/**\r\n\t * Returns true if the given rect fully covers the other one\r\n\t */\r\n\tcovers(x2, y2, w2, h2) {\r\n\t\tif (arguments.length === 1) {\r\n\t\t\tlet r = x2;\r\n\r\n\t\t\tx2 = r.x;\r\n\t\t\ty2 = r.y;\r\n\t\t\tw2 = r.width;\r\n\t\t\th2 = r.height;\r\n\t\t}\r\n\r\n\t\treturn (x2 >= this.x &&\r\n\t\t\ty2 >= this.y &&\r\n\t\t\tx2 + w2 <= this.x + this.width &&\r\n\t\t\ty2 + h2 <= this.y + this.height);\r\n\t}\r\n\r\n\t/**\r\n\t * Assumes that neither of rectangles is zero-area\r\n\t */\r\n\tconvexHull(x2, y2, w2, h2) {\r\n\t\tif (arguments.length === 1) {\r\n\t\t\tlet r = x2;\r\n\r\n\t\t\tx2 = r.x;\r\n\t\t\ty2 = r.y;\r\n\t\t\tw2 = r.width;\r\n\t\t\th2 = r.height;\r\n\t\t}\r\n\r\n\t\tlet x = Math.min(this.x, x2);\r\n\t\tlet y = Math.min(this.y, y2);\r\n\t\tlet width = Math.max(this.x + this.width, x2 + w2) - x;\r\n\t\tlet height = Math.max(this.y + this.height, y2 + h2) - y;\r\n\r\n\t\treturn new Rect(x, y, width, height);\r\n\t}\r\n\r\n\tintersection(x2, y2, w2, h2) {\r\n\t\tif (arguments.length === 1) {\r\n\t\t\tlet r = x2;\r\n\r\n\t\t\tx2 = r.x;\r\n\t\t\ty2 = r.y;\r\n\t\t\tw2 = r.width;\r\n\t\t\th2 = r.height;\r\n\t\t}\r\n\r\n\t\tlet x = Math.max(this.x, x2);\r\n\t\tlet y = Math.max(this.y, y2);\r\n\t\tlet width = Math.min(this.x + this.width, x2 + w2) - x;\r\n\t\tlet height = Math.min(this.y + this.height, y2 + h2) - y;\r\n\r\n\t\tif (width <= 0 || height <= 0) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn new Rect(x, y, width, height);\r\n\t}\r\n\r\n\tcontainsPoint(x, y) {\r\n\t\treturn x >= this.x && x < this.x + this.width &&\r\n\t\t\ty >= this.y && y < this.y + this.height;\r\n\t}\r\n\r\n\t/**\r\n\t * Given a rectangular grid, with the grid cell size cellW, cellH test which cells\r\n\t * are overlapped by the rectangle. cellsInRow and cellsInColumn are used only\r\n\t * to limit the coordinates (to prevent going out of bounds in arrays for example)\r\n\t *\r\n\t */\r\n\tgetOverlappingGridCells(cellW, cellH, cellsInRow, cellsInColumn) {\r\n\t\tlet rectX = Math.max(0, Math.floor(this.x / cellW));\r\n\t\tlet rectY = Math.max(0, Math.floor(this.y / cellH));\r\n\t\tlet rectWidth = Math.min(cellsInRow - rectX,\r\n\t\t\tMath.floor((this.x + this.width) / cellW) - rectX + 1);\r\n\t\tlet rectHeight = Math.min(cellsInColumn - rectY,\r\n\t\t\tMath.floor((this.y + this.height) / cellH) - rectY + 1);\r\n\r\n\t\treturn new Rect(rectX, rectY, rectWidth, rectHeight);\r\n\t}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/Rect.js\n **/","'use strict';\n\nimport Keyboard from './input/Keyboard';\nimport TouchInputHandler from './input/TouchInputHandler';\nimport MouseInputHandler from './input/MouseInputHandler';\nimport DirtyRectangleManager from './DirtyRectangleManager';\nimport ImageManager from './ImageManager';\nimport {isTouchDevice} from './utils';\n\nexport default class Engine {\n\n\tconstructor(id, vpWidth, vpHeight) {\n\t\tthis._canvas = document.getElementById(id);\n\t\tthis._ctx = this._canvas.getContext('2d');\n\t\tthis._scenes = {};\n\t\tthis._currentScene = null;\n\t\tthis._lastTick = Date.now();\n\t\tthis._input = isTouchDevice() ? TouchInputHandler : MouseInputHandler;\n\t\tthis._keyboard = new Keyboard(this._canvas);\n\n\t\tthis._dirtyRects = new DirtyRectangleManager();\n\t\tthis._dirtyRects.setViewport(vpWidth, vpHeight);\n\t\tthis._resourceManager = new ImageManager();\n\t\tthis._tick = this._tick.bind(this);\n\n\t\tthis._gameContext = {\n\t\t\tresourceManager: this._resourceManager,\n\t\t\twidth: this._canvas.width,\n\t\t\theight: this._canvas.height\n\t\t};\n\t}\n\n\tloadResources(resourceData, onDone) {\n\t\tthis._resourceManager.load(resourceData, onDone, function onProgress() {\n\t\t});\n\t}\n\n\tgetResource(name) {\n\t\treturn this._resourceManager.get(name);\n\t}\n\n\tscene(id, scene) {\n\t\tif (scene === undefined) {\n\t\t\tthis._useScene(id);\n\t\t} else {\n\t\t\tscene.init(this._gameContext);\n\t\t\tthis._scenes[id] = scene;\n\t\t\tif (!this._currentScene) {\n\t\t\t\tthis._useScene(id);\n\t\t\t}\n\t\t}\n\t}\n\n\tstart() {\n\t\tthis._lastTick = Date.now();\n\t\tthis._tick();\n\t}\n\n\t_tick() {\n\t\trequestAnimationFrame(this._tick);\n\n\t\t// delta time\n\t\tlet dt = Date.now() - this._lastTick;\n\n\t\tthis._lastTick = Date.now();\n\n\t\t// frame context\n\t\tlet fc = {\n\t\t\tdt: dt,\n\t\t\tinput: this._input,\n\t\t\tkeyboard: this._keyboard,\n\t\t\tgraphContext: this._ctx,\n\t\t\twidth: this._canvas.width,\n\t\t\theight: this._canvas.height,\n\t\t\tdirtyRects: this._dirtyRects\n\t\t};\n\n\t\tif (!this._currentScene) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._update(fc);\n\n\t\tif (!this._dirtyRects.isClean()) {\n\t\t\tthis._draw(fc);\n\t\t}\n\n\t\tthis._keyboard.resetPressed();\n\t}\n\n\t_update(fc) {\n\t\tthis._currentScene.update(fc);\n\t}\n\n\t_draw(fc) {\n\t\tlet rect = this._dirtyRects.getDirtyRect();\n\n\t\tthis._ctx.save();\n\t\tthis._ctx.beginPath();\n\t\tthis._ctx.rect(rect.x, rect.y, rect.width, rect.height);\n\t\tthis._ctx.clip();\n\t\tthis._currentScene.draw(fc);\n\t\tthis._dirtyRects.clear();\n\t\tthis._ctx.restore();\n\t}\n\n\t_useScene(id) {\n\t\tthis._currentScene = this._scenes[id];\n\t\tthis._dirtyRects.markAllDirty();\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/Engine.js\n **/","'use strict';\n\nimport EventEmitter from '../EventEmitter';\n\nexport default class Keyboard extends EventEmitter {\n\tconstructor(element) {\n\t\tsuper();\n\n\t\tthis._element = null;\n\t\tthis._stopDomEvents = true;\n\t\tthis._keys = [];\n\t\tthis._pressed = [];\n\n\t\tthis._onKeyDown = this._onKeyDown.bind(this);\n\t\tthis._onKeyUp = this._onKeyUp.bind(this);\n\n\t\tthis.attachTo(element);\n\t}\n\n\tdetach() {\n\t\tif (this._element) {\n\t\t\tthis._detachDomListeners();\n\t\t\tthis._element = null;\n\t\t}\n\t}\n\n\tattachTo(el) {\n\t\tif (this._element) {\n\t\t\tthis._detachDomListeners();\n\t\t}\n\n\t\tthis._element = el;\n\t\tif (el) {\n\t\t\tthis._attachDomListeners();\n\t\t}\n\t\tel.focus();\n\t}\n\n\tgetStopDomEvents() {\n\t\treturn this._stopDomEvents;\n\t}\n\n\tsetStopDomEvents(stopDomEvents) {\n\t\tthis._stopDomEvents = stopDomEvents;\n\t}\n\n\tisDown(code) {\n\t\treturn this._keys[code];\n\t}\n\n\tisPressed(code) {\n\t\treturn this._pressed[code];\n\t}\n\n\tresetPressed() {\n\t\tthis._pressed = [];\n\t}\n\n\t_stopEventIfRequired(e) {\n\t\tif (this._stopDomEvents) {\n\t\t\te.stopPropagation();\n\t\t\te.preventDefault();\n\t\t}\n\t}\n\n\t_onKeyDown(e) {\n\t\tthis._pressed[e.keyCode] = !this.isDown(e.keyCode);\n\t\tthis._keys[e.keyCode] = true;\n\t\tthis._stopEventIfRequired(e);\n\t}\n\n\t_onKeyUp(e) {\n\t\tthis._keys[e.keyCode] = false;\n\t\tthis._pressed[e.keyCode] = false;\n\t\tthis._stopEventIfRequired(e);\n\t}\n\n\t/**\n\t * Attach the listeners to the mouseXXX DOM events\n\t */\n\t_attachDomListeners() {\n\t\tlet el = this._element;\n\n\t\tel.addEventListener('keydown', this._onKeyDown, false);\n\t\tel.addEventListener('keyup', this._onKeyUp, false);\n\t}\n\n\t/**\n\t * Attach the listeners to the mouseXXX DOM events\n\t */\n\t_detachDomListeners() {\n\t\tlet el = this._element;\n\n\t\tel.removeEventListener('keydown', this._onKeyDown, false);\n\t\tel.removeEventListener('keyup', this._onKeyUp, false);\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/input/Keyboard.js\n **/","'use strict';\n\nexport default class EventEmitter {\n\tconstructor() {\n\t\tthis._listeners = {};\n\t}\n\n\taddListener(type, listener) {\n\t\tif (typeof listener !== 'function') {\n\t\t\tthrow Error('Listener must be a function');\n\t\t}\n\n\t\tif (!this._listeners[type]) {\n\t\t\tthis._listeners[type] = [];\n\t\t}\n\n\t\tthis._listeners[type].push(listener);\n\t}\n\n\tremoveListener(type, listener) {\n\t\tif (typeof listener !== 'function') {\n\t\t\tthrow Error('Listener must be a function');\n\t\t}\n\n\t\tif (!this._listeners[type]) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet position = this._listeners[type].indexOf(listener);\n\n\t\tif (position !== -1) {\n\t\t\tthis._listeners[type].splice(position, 1);\n\t\t}\n\t}\n\n\tremoveAllListeners(type) {\n\t\tif (type) {\n\t\t\tthis._listeners[type] = [];\n\t\t} else {\n\t\t\tthis._listeners = {};\n\t\t}\n\t}\n\n\temit(type, event) {\n\t\tif (!(this._listeners[type] && this._listeners[type].length)) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor (let i = 0; i < this._listeners[type].length; i++) {\n\t\t\tthis._listeners[type][i].call(this, event);\n\t\t}\n\t}\n}\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/EventEmitter.js\n **/","'use strict';\n\n/**\n * The implementation of the InputHandler for the touch interfaces.\n * Based on the touch events.\n */\n\nimport InputHandlerBase from './InputHandlerBase';\n\nexport default class TouchInputHandler extends InputHandlerBase {\n\n\tconstructor(element) {\n\t\tsuper(element);\n\t\tthis._isDown = false;\n\t\tthis._lastInteractionCoordinates = {\n\t\t\tx: 0,\n\t\t\ty: 0\n\t\t};\n\t\tthis._onDownDomEvent = this._onDownDomEvent.bind(this);\n\t\tthis._onUpDomEvent = this._onUpDomEvent.bind(this);\n\t\tthis._onMoveDomEvent = this._onMoveDomEvent.bind(this);\n\t\tthis.attachTo(element);\n\t}\n\n\tisDown() {\n\t\treturn this._isDown;\n\t}\n\n\tgetCoordinates() {\n\t\treturn this._lastInteractionCoordinates;\n\t}\n\n\t_attachDomListeners() {\n\t\tlet el = this._element;\n\n\t\tel.addEventListener('touchstart', this._onDownDomEvent, false);\n\t\tel.addEventListener('touchend', this._onUpDomEvent, false);\n\t\tel.addEventListener('touchcancel', this._onUpDomEvent, false);\n\t\tel.addEventListener('touchmove', this._onMoveDomEvent, false);\n\t}\n\n\t_detachDomListeners() {\n\t\tlet el = this._element;\n\n\t\tel.removeEventListener('touchstart', this._onDownDomEvent, false);\n\t\tel.removeEventListener('touchend', this._onUpDomEvent, false);\n\t\tel.removeEventListener('touchcancel', this._onUpDomEvent, false);\n\t\tel.removeEventListener('touchmove', this._onMoveDomEvent, false);\n\t}\n\n\t_onDownDomEvent(e) {\n\t\tthis._lastInteractionCoordinates = this._getInputCoordinates(e);\n\t\tthis._isDown = true;\n\t\tsuper._onDownDomEvent(e);\n\t}\n\n\t_onUpDomEvent(e) {\n\t\tthis.emit('up', {\n\t\t\tx: this._lastInteractionCoordinates.x,\n\t\t\ty: this._lastInteractionCoordinates.y,\n\t\t\tmoved: this._moving,\n\t\t\tdomEvent: e\n\t\t});\n\t\tthis._stopEventIfRequired(e);\n\t\tthis._isDown = false;\n\t\tthis._moving = false;\n\t}\n\n\t_onMoveDomEvent(e) {\n\t\tthis._lastInteractionCoordinates = this._getInputCoordinates(e);\n\t\tsuper._onMoveDomEvent(e);\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/input/TouchInputHandler.js\n **/","'use strict';\n\nimport EventEmitter from '../EventEmitter';\n\n/**\n * The \"abstract\" base for MouseInputHandler and TouchInputHandler. This class is not\n * supposed to be instantiated directly. It provides the common base for touch and\n * mouse input handling.\n *\n * @param element the DOM element to work with - concrete input handlers will\n * register as event handlers of this element. In gamedev projects the\n * element is usually the main canvas\n */\nexport default class InputHandlerBase extends EventEmitter {\n\n\tconstructor(element) {\n\t\tsuper();\n\n\t\t// The DOM element, descendants will set this in attach()\n\t\tthis._element = null;\n\t\tthis._moving = false;\n\t\tthis._lastMoveCoordinates = null;\n\t\tthis._moveThreshold = 10;\n\t\tthis._stopDomEvents = false;\n\t}\n\n\tdetach() {\n\t\tif (this._element) {\n\t\t\tthis._detachDomListeners();\n\t\t\tthis._element = null;\n\t\t}\n\t}\n\n\tattachTo(el) {\n\t\tif (this._element) {\n\t\t\tthis._detachDomListeners();\n\t\t}\n\n\t\tthis._element = el;\n\t\tif (el) {\n\t\t\tthis._attachDomListeners();\n\t\t}\n\t}\n\n\tgetMoveThreshold() {\n\t\treturn this._moveThreshold;\n\t}\n\n\tsetMoveThreshold(moveThreshold) {\n\t\tthis._moveThreshold = moveThreshold;\n\t}\n\n\tgetStopDomEvents() {\n\t\treturn this._stopDomEvents;\n\t}\n\n\tsetStopDomEvents(stopDomEvents) {\n\t\tthis._stopDomEvents = stopDomEvents;\n\t}\n\n\t/**\n\t * Listens to the \"down\" DOM events: mousedown and touchstart.\n\t * @param e DOM Event\n\t */\n\t_onDownDomEvent(e) {\n\t\t// We must save this coordinates to support the moveThreshold - this\n\t\t// may be the starting point of the movement, we can't simply\n\t\tlet coords = this._lastMoveCoordinates = this._getInputCoordinates(e);\n\n\t\t// Emit \"down\" event - all coordinates together with the\n\t\t// original DOM event are passed to listeners\n\t\tthis.emit('down', {x: coords.x, y: coords.y, domEvent: e});\n\n\t\t// Usually we want to stop original the DOM events\n\t\t// from further browser processing.\n\t\tthis._stopEventIfRequired(e);\n\t}\n\n\t/**\n\t * Listens to the \"up\" DOM events: mouseup and touchend. Touchend\n\t * doesn't have any coordinates associated with it so this function\n\t * will be overridden in TouchInputHandler\n\t * @param e DOM Event\n\t */\n\t_onUpDomEvent(e) {\n\t\t// Works exactly the same way as _onDownDomEvent\n\t\tlet coords = this._getInputCoordinates(e);\n\n\t\tthis.emit('up', {\n\t\t\tx: coords.x,\n\t\t\ty: coords.y,\n\t\t\tmoved: this._moving,\n\t\t\tdomEvent: e\n\t\t});\n\n\t\tthis._stopEventIfRequired(e);\n\n\t\t// The interaction is ended. Reset the flag\n\t\tthis._moving = false;\n\t}\n\n\t/**\n\t * Listens to the \"move\" DOM events: mousemove and touchmove.\n\t * This function keeps track of the distance travelled since the last\n\t * \"move\" action, besides it ignores the movement and swallows the event\n\t * if we are still within the _moveThreshold\n\t * @param e DOM event\n\t */\n\t_onMoveDomEvent(e) {\n\t\tlet coords = this._getInputCoordinates(e);\n\n\t\t// Calculate deltas\n\t\tlet deltaX = coords.x - this._lastMoveCoordinates.x;\n\t\tlet deltaY = coords.y - this._lastMoveCoordinates.y;\n\n\t\t// Check threshold, if the distance from the initial\n\t\t// tap to the current position is more than the threshold\n\t\t// value - qualify it as a real movement\n\t\tlet deltaMove = Math.sqrt(deltaX * deltaX + deltaY * deltaY);\n\n\t\tif (!this._moving && deltaMove > this._moveThreshold) {\n\t\t\tthis._moving = true;\n\t\t}\n\n\t\t// If the current interaction is \"moving\" (we crossed the threshold already) then emit\n\t\t// the event, otherwise, just ignore the interaction.\n\t\tif (this._moving) {\n\t\t\tthis.emit('move', {\n\t\t\t\tx: coords.x,\n\t\t\t\ty: coords.y,\n\t\t\t\tdeltaX: deltaX,\n\t\t\t\tdeltaY: deltaY,\n\t\t\t\tdomEvent: e\n\t\t\t});\n\t\t\tthis._lastMoveCoordinates = coords;\n\t\t}\n\n\t\tthis._stopEventIfRequired(e);\n\t};\n\n\t_stopEventIfRequired(e) {\n\t\tif (this._stopDomEvents) {\n\t\t\te.stopPropagation();\n\t\t\te.preventDefault();\n\t\t}\n\t}\n\n\t_getInputCoordinates(e) {\n\t\tlet element = this._element;\n\t\tlet coords = e.targetTouches ? e.targetTouches[0] : e;\n\n\t\tlet x = (coords.pageX || coords.clientX + document.body.scrollLeft) -\n\t\t\telement.offsetLeft;\n\n\t\tlet y = (coords.pageY || coords.clientY + document.body.scrollTop) -\n\t\t\telement.offsetTop;\n\n\t\t// TODO: Change to destructuring\n\t\treturn {\n\t\t\tx: x,\n\t\t\ty: y\n\t\t};\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/input/InputHandlerBase.js\n **/","'use strict';\n\nimport InputHandlerBase from './InputHandlerBase';\n\n/**\n * The implementation of the InputHandler for the desktop\n * browser based on the mouse events.\n */\nexport default class MouseInputHandler extends InputHandlerBase {\n\n\tconstructor(element) {\n\t\tsuper(element);\n\n\t\t// We need additional property to track if the\n\t\t// mouse is down.\n\t\tthis._mouseDown = false;\n\n\t\t// Bound functions\n\t\tthis._onDownDomEvent = this._onDownDomEvent.bind(this);\n\t\tthis._onUpDomEvent = this._onUpDomEvent.bind(this);\n\t\tthis._onMoveDomEvent = this._onMoveDomEvent.bind(this);\n\t\tthis._onMouseOut = this._onMouseOut.bind(this);\n\t\tthis._onHoverDomEvent = this._onHoverDomEvent.bind(this);\n\n\t\tthis._coords = {x: -1, y: -1};\n\t\tthis.attachTo(element);\n\t}\n\n\tisDown() {\n\t\treturn this._mouseDown;\n\t}\n\n\tgetCoordinates() {\n\t\treturn this._coords;\n\t}\n\n\t/**\n\t * Attach the listeners to the mouseXXX DOM events\n\t */\n\t_attachDomListeners() {\n\t\tlet el = this._element;\n\n\t\tel.addEventListener('mousedown', this._onDownDomEvent, false);\n\t\tel.addEventListener('mouseup', this._onUpDomEvent, false);\n\t\tel.addEventListener('mousemove', this._onMoveDomEvent, false);\n\t\tel.addEventListener('mouseout', this._onMouseOut, false);\n\t}\n\n\t/**\n\t * Attach the listeners to the mouseXXX DOM events\n\t */\n\t_detachDomListeners() {\n\t\tlet el = this._element;\n\n\t\tel.removeEventListener('mousedown', this._onDownDomEvent, false);\n\t\tel.removeEventListener('mouseup', this._onUpDomEvent, false);\n\t\tel.removeEventListener('mousemove', this._onMoveDomEvent, false);\n\t\tel.removeEventListener('mouseout', this._onMouseOut, false);\n\t}\n\n\t/**\n\t * This method (and the next one) is overridden,\n\t * because we have to track the state of the mouse.\n\t * This could also be done in the separate listener.\n\t */\n\t_onDownDomEvent(e) {\n\t\tthis._mouseDown = true;\n\t\tsuper._onDownDomEvent(e);\n\t}\n\n\t_onUpDomEvent(e) {\n\t\tthis._mouseDown = false;\n\t\tInputHandlerBase.prototype._onUpDomEvent.call(this, e);\n\t}\n\n\t/**\n\t * We process the move event only if the mouse button is\n\t * pressed, otherwise the DOM event is ignored.\n\t */\n\t_onMoveDomEvent(e) {\n\t\tif (this._mouseDown) {\n\t\t\tsuper._onMoveDomEvent(e);\n\t\t} else {\n\t\t\tthis._onHoverDomEvent(e);\n\t\t}\n\t}\n\n\t/**\n\t * Hover is for pointer-enabled interfaces. Should rename\n\t * move -> drag\n\t * hover -> move\n\t *\n\t * TODO: support deltas in hover\n\t */\n\t_onHoverDomEvent(e) {\n\t\tlet coords = this._coords = this._getInputCoordinates(e);\n\n\t\tthis.emit('hover', {\n\t\t\tx: coords.x, y: coords.y,\n\t\t\t/* deltaX: deltaX, deltaY: deltaY, */ domEvent: e\n\t\t});\n\t\tthis._stopEventIfRequired(e);\n\t}\n\n\t_onMouseOut() {\n\t\tthis._mouseDown = false;\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/input/MouseInputHandler.js\n **/","'use strict';\n\nexport default class ImageManager {\n\tconstructor() {\n\t\tthis._imageQueue = [];\n\t\tthis._images = {};\n\t}\n\n\t_addImage(key, path) {\n\t\tthis._imageQueue.push({\n\t\t\tkey: key,\n\t\t\tpath: path\n\t\t});\n\t};\n\n\tload(images, onDone, onProgress) {\n\t\tlet noop = () => {};\n\t\tlet queue = this._imageQueue;\n\n\t\tfor (let im in images) {\n\t\t\tthis._addImage(im, images[im]);\n\t\t}\n\n\t\tonDone = onDone || noop;\n\t\tonProgress = onProgress || noop;\n\n\t\tthis._imageQueue = [];\n\n\t\tif (queue.length === 0) {\n\t\t\tonProgress(0, 0, null, null, true);\n\t\t\treturn;\n\t\t}\n\n\t\tlet itemCounter = {\n\t\t\tloaded: 0,\n\t\t\ttotal: queue.length\n\t\t};\n\n\t\tfor (let i = 0; i < queue.length; i++) {\n\t\t\tthis._loadItem(queue[i], itemCounter, onDone, onProgress);\n\t\t}\n\t}\n\n\t_loadItem(queueItem, itemCounter, onDone, onProgress) {\n\t\tlet self = this;\n\t\tlet img = new Image();\n\n\t\timg.onload = function () {\n\t\t\tself._images[queueItem.key] = img;\n\t\t\tself._onItemLoaded(queueItem, itemCounter,\n\t\t\t\tonDone, onProgress, true);\n\t\t};\n\n\t\timg.onerror = function () {\n\t\t\tself._images[queueItem.key] = self._placeholder;\n\t\t\tself._onItemLoaded(queueItem, itemCounter,\n\t\t\t\tonDone, onProgress, false);\n\t\t};\n\t\timg.src = queueItem.path;\n\t}\n\n\t_onItemLoaded(queueItem, itemCounter, onDone, onProgress, success) {\n\t\titemCounter.loaded++;\n\t\tonProgress(itemCounter.loaded, itemCounter.total,\n\t\t\tqueueItem.key, queueItem.path, success);\n\n\t\tif (itemCounter.loaded === itemCounter.total) {\n\t\t\tonDone();\n\t\t}\n\t}\n\n\tget(key) {\n\t\treturn this._images[key];\n\t}\n}\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/ImageManager.js\n **/","'use strict';\n\n/**\n * Checks if we're working with the touchscreen or with the\n * regular desktop browser. Used to determine, what kind of events should we use:\n * mouse events or touch events.\n */\nfunction isTouchDevice() {\n\treturn ('ontouchstart' in document.documentElement);\n}\n\nfunction dist(x1, y1, x2, y2) {\n\treturn Math.sqrt((x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2));\n}\n\nexport {isTouchDevice, dist};\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/utils.js\n **/","'use strict';\n\nexport default class GameObject {\n\tconstructor() {\n\t\tthis._x = 0;\n\t\tthis._y = 0;\n\t\tthis._width = 0;\n\t\tthis._height = 0;\n\n\t\tthis._id = GameObject.uid++;\n\t\tthis._name = 'object_' + this._id;\n\n\t\tthis._anchorX = 0;\n\t\tthis._anchorY = 0;\n\n\t\tthis._rot = 0;\n\n\t\tthis._scene = null;\n\t\tthis._parent = null;\n\t\tthis._children = [];\n\t}\n\n\tupdate(fc) {\n\t\tthis._children.forEach(it => it.update(fc));\n\t}\n\n\tdraw(fc) {\n\t\tthis._children.forEach(it => it.draw(fc));\n\t}\n\n\taddChild(child) {\n\t\tthis._children.push(child);\n\t\tchild.setParent(this);\n\t}\n\n\tremoveChild(child) {\n\t\tlet idx = this._children.indexOf(child);\n\n\t\tif (idx > -1) {\n\t\t\tchild.setParent(null);\n\t\t\treturn this._children.splice(idx, 1);\n\t\t}\n\t}\n\n\tgetChildren() {\n\t\treturn this._children;\n\t}\n\n\tsetParent(parent) {\n\t\tthis._parent = parent;\n\t}\n\n\tsetScene(scene) {\n\t\tthis._scene = scene;\n\t}\n\n\tgetScene() {\n\t\treturn this._scene;\n\t}\n\n\tgetParent() {\n\t\treturn this._parent;\n\t}\n\n\tgetId() {\n\t\treturn this._id;\n\t}\n\n\tgetName() {\n\t\treturn this._name;\n\t}\n\n\tsetName() {\n\t\treturn this._name;\n\t}\n\n\tsetPos(x, y) {\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t}\n\n\tsetSize(w, h) {\n\t\tthis._width = w;\n\t\tthis._height = h;\n\t}\n\n\tgetWidth() {\n\t\treturn this._width;\n\t}\n\n\tgetHeight() {\n\t\treturn this._height;\n\t}\n\n\tmove(dx, dy) {\n\t\tthis._x += dx;\n\t\tthis._y += dy;\n\t}\n\n\tgetPos() {\n\t\treturn {\n\t\t\tx: this._x,\n\t\t\ty: this._y\n\t\t};\n\t}\n\n\tgetTop() {\n\t\treturn this._y;\n\t}\n\n\tgetBottom() {\n\t\treturn this._y + this._height;\n\t}\n\n\tgetLeft() {\n\t\treturn this._x;\n\t}\n\n\tgetRight() {\n\t\treturn this._x + this._width;\n\t}\n\n\tdetach() {\n\t\tif (!this._parent) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._parent.removeChild(this);\n\t}\n}\n// should be static\nGameObject.uid = 1;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/GameObject.js\n **/","'use strict';\n\nimport GameObject from './GameObject';\n\nexport default class GameScene extends GameObject {\n\tconstructor() {\n\t\tsuper();\n\t\tthis._gameContext = null;\n\t}\n\n\tinit(gameContext) {\n\t\tthis._gameContext = gameContext;\n\t}\n\n\taddChild(child) {\n\t\tsuper.addChild(child);\n\t}\n\n\tregisterObject(obj) {\n\n\t}\n\n\tderegisterObject(obj) {\n\n\t}\n\n\tgetResource(name) {\n\t\treturn this._gameContext.resourceManager.get(name);\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/GameScene.js\n **/","'use strict';\n\nimport Rect from './Rect';\n\nlet MathUtils = {};\n\nMathUtils.getBoundingRectangle = function (points) {\n\tlet minX = Number.MAX_VALUE;\n\tlet minY = Number.MAX_VALUE;\n\tlet maxX = Number.MIN_VALUE;\n\tlet maxY = Number.MIN_VALUE;\n\n\tfor (let i = 0; i < points.length; i++) {\n\t\t// TODO Destructuring?\n\t\tlet x = points[i][0];\n\t\tlet y = points[i][1];\n\n\t\tif (x < minX) {\n\t\t\tminX = x;\n\t\t}\n\n\t\tif (x > maxX) {\n\t\t\tmaxX = x;\n\t\t}\n\n\t\tif (y < minY) {\n\t\t\tminY = y;\n\t\t}\n\n\t\tif (y > maxY) {\n\t\t\tmaxY = y;\n\t\t}\n\t}\n\n\tlet epsilon = Math.max(maxX - minX, maxY - minY) * 0.05;\n\n\tminX -= epsilon;\n\tmaxX += epsilon;\n\tminY -= epsilon;\n\tmaxY += epsilon;\n\treturn new Rect(minX, minY, maxX - minX, maxY - minY);\n};\n\n/**\n * http://stackoverflow.com/questions/563198\n */\n/* eslint-disable camelcase */\nMathUtils.linesIntersect = function (p0_x, p0_y, p1_x, p1_y, p2_x, p2_y, p3_x, p3_y) {\n\n\tlet s1_x, s1_y, s2_x, s2_y;\n\n\ts1_x = p1_x - p0_x;\n\ts1_y = p1_y - p0_y;\n\ts2_x = p3_x - p2_x;\n\ts2_y = p3_y - p2_y;\n\n\tlet s, t;\n\n\ts = (-s1_y * (p0_x - p2_x) + s1_x * (p0_y - p2_y)) / (-s2_x * s1_y + s1_x * s2_y);\n\tt = (s2_x * (p0_y - p2_y) - s2_y * (p0_x - p2_x)) / (-s2_x * s1_y + s1_x * s2_y);\n\n\tif (s >= 0 && s <= 1 && t >= 0 && t <= 1) {\n\t\treturn [p0_x + (t * s1_x), p0_y + (t * s1_y)];\n\t}\n\n\treturn null;\n};\n/* eslint-enable camelcase */\n\nMathUtils.sign = function (number) {\n\treturn number > 0 ? 1 : number === 0 ? 0 : -1;\n};\n\nMathUtils.pointInsidePolygon = function (px, py, polygon, rayX, rayY) {\n\tif ((rayX === undefined || rayY === undefined)) {\n\t\tlet rect = MathUtils.getBoundingRectangle(polygon);\n\n\t\trayX = rect.x + rect.width;\n\t\trayY = py;\n\t}\n\n\tlet intersectCount = 0;\n\n\tfor (let i = 0; i < polygon.length; i++) {\n\t\tlet polyX0 = polygon[i][0];\n\t\tlet polyY0 = polygon[i][1];\n\t\tlet polyX1 = i + 1 === polygon.length ? polygon[0][0] : polygon[i + 1][0];\n\t\tlet polyY1 = i + 1 === polygon.length ? polygon[0][1] : polygon[i + 1][1];\n\n\t\tif (MathUtils.linesIntersect(px, py, rayX, rayY, polyX0, polyY0, polyX1, polyY1)) {\n\t\t\tintersectCount++;\n\t\t}\n\t}\n\treturn intersectCount % 2 === 1;\n};\n\n// Can be probably optimized by checking that the both points are on one\n// \"side\" of the poly\nMathUtils.segmentIntersectsPolygon = function (x0, y0, x1, y1, polygon) {\n\tfor (let i = 0; i < polygon.length; i++) {\n\t\tlet polyX0 = polygon[i][0];\n\t\tlet polyY0 = polygon[i][1];\n\t\tlet polyX1 = i + 1 === polygon.length ? polygon[0][0] : polygon[i + 1][0];\n\t\tlet polyY1 = i + 1 === polygon.length ? polygon[0][1] : polygon[i + 1][1];\n\n\t\tif (MathUtils.linesIntersect(x0, y0, x1, y1, polyX0, polyY0, polyX1, polyY1)) {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n};\n\nMathUtils.distance = function (x0, y0, x1, y1) {\n\treturn Math.sqrt((x0 - x1) * (x0 - x1) + (y0 - y1) * (y0 - y1));\n};\n\nMathUtils.distanceSquared = function (x0, y0, x1, y1) {\n\treturn (x0 - x1) * (x0 - x1) + (y0 - y1) * (y0 - y1);\n};\n\n// http://stackoverflow.com/questions/849211/shortest-distance-between-a-point-and-a-line-segment\nMathUtils.distanceFromPointToSegment = function (pX, pY, segStartX, segStartY, segEndX, segEndY) {\n\n\tlet lengthSquared = MathUtils.distanceSquared(segStartX, segStartY, segEndX, segEndY);\n\n\tif (lengthSquared === 0) {\n\t\treturn MathUtils.distance(pX, pY, segStartX, segStartY);\n\t}\n\n\tlet t = ((pX - segStartX) * (segEndX - segStartX) +\n\t\t(pY - segStartY) * (segEndY - segStartY)) / lengthSquared;\n\n\tif (t < 0) {\n\t\treturn MathUtils.distance(pX, pY, segStartX, segStartY);\n\t}\n\n\tif (t > 1) {\n\t\treturn MathUtils.distance(pX, pY, segEndX, segEndY);\n\t}\n\n\treturn MathUtils.distance(pX, pY,\n\t\tsegStartX + t * (segEndX - segStartX),\n\t\tsegStartY + t * (segEndY - segStartY));\n};\n\nMathUtils.distanceFromPointToPolygon = function (px, py, polyPoints) {\n\tlet minDist = MathUtils.distanceFromPointToSegment(px, py,\n\t\tpolyPoints[polyPoints.length - 1][0], polyPoints[polyPoints.length - 1][1],\n\t\tpolyPoints[0][0], polyPoints[0][1]);\n\n\tfor (let i = 1; i < polyPoints.length; i++) {\n\t\tlet dist = MathUtils.distanceFromPointToSegment(px, py,\n\t\t\tpolyPoints[i - 1][0], polyPoints[i - 1][1],\n\t\t\tpolyPoints[i][0], polyPoints[i][1]);\n\n\t\tif (dist < minDist) {\n\t\t\tminDist = dist;\n\t\t}\n\t}\n\n\treturn minDist;\n};\n\nexport default MathUtils;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/MathUtils.js\n **/","'use strict';\n\nimport Rectangle from './Rectangle';\nimport Shapes from './Shapes';\nimport Sprite from './Sprite';\nimport SpriteSheet from './SpriteSheet';\nimport TileSheet from './TileSheet';\nimport TileMapOrtho from './map/TileMapOrtho';\n\nexport {Rectangle, Shapes, Sprite, SpriteSheet, TileSheet, TileMapOrtho};\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/ui/index.js\n **/","'use strict';\n\nimport GameObject from '../GameObject';\n\nexport default class Rectangle extends GameObject {\n\n\tdraw(fc) {\n\t\tlet gc = fc.graphContext;\n\n\t\tgc.fillStyle = 'green';\n\t\tgc.fillRect(this._x, this._y, 10, 10);\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/ui/Rectangle.js\n **/","'use strict';\n\n/**\n * A number of utility methods for drawing the polygons,\n * agents (boids), arrows, fills, etc.\n */\nlet Shapes = {};\n\nShapes.drawMarker = function (ctx, x, y, size, lineWidth, color) {\n\tsize = size || 10;\n\tlineWidth = lineWidth || 5;\n\tcolor = color || 'blue';\n\tctx.save();\n\tctx.strokeStyle = color;\n\tctx.lineWidth = 5;\n\tctx.beginPath();\n\tctx.moveTo(x - size, y + size);\n\tctx.lineTo(x + size, y - size);\n\tctx.moveTo(x - size, y - size);\n\tctx.lineTo(x + size, y + size);\n\tctx.stroke();\n\tctx.restore();\n};\n\nShapes.drawArrow1 = function (ctx, x, y, length, offsetFromCenter, wingLength, wingDepth, angle) {\n\tlength = length || 50;\n\toffsetFromCenter = offsetFromCenter || 15;\n\twingLength = wingLength || 10;\n\twingDepth = wingDepth || 5;\n\tangle = angle || 0;\n\n\tctx.save();\n\tctx.fillStyle = 'green';\n\tctx.beginPath();\n\n\tif (angle) {\n\t\tctx.translate(x, y);\n\t\tctx.rotate(angle);\n\t\tctx.translate(-x, -y);\n\t}\n\n\tctx.moveTo(x + offsetFromCenter, y);\n\tctx.lineTo(x + offsetFromCenter - wingDepth, y - wingLength);\n\tctx.lineTo(x + offsetFromCenter + length, y);\n\tctx.lineTo(x + offsetFromCenter - wingDepth, y + wingLength);\n\n\tctx.closePath();\n\tctx.fill();\n\tctx.restore();\n};\n\nShapes.drawPolygon = function (ctx, points) {\n\tctx.save();\n\tctx.strokeStyle = 'lightblue';\n\tctx.fillStyle = 'rgba(173, 216, 230, 1)';\n\tctx.lineWidth = 5;\n\tctx.beginPath();\n\tctx.moveTo(points[0][0], points[0][1]);\n\tfor (let i = 1; i < points.length; i++) {\n\t\tctx.lineTo(points[i][0], points[i][1]);\n\t}\n\tctx.closePath();\n\tctx.fill();\n\tctx.stroke();\n\tctx.restore();\n};\n\nShapes.fillPolygon = function (ctx, points) {\n\tctx.save();\n\n\tctx.strokeStyle = 'grey';\n\tctx.lineWidth = 1;\n\n\tlet minX = Number.MAX_VALUE;\n\tlet minY = Number.MAX_VALUE;\n\tlet maxX = Number.MIN_VALUE;\n\tlet maxY = Number.MIN_VALUE;\n\n\tlet angle = Math.PI / 4;\n\n\tfor (let i = 0; i < points.length; i++) {\n\t\tif (points[i][0] < minX) {\n\t\t\tminX = points[i][0];\n\t\t}\n\n\t\tif (points[i][1] < minY) {\n\t\t\tminY = points[i][1];\n\t\t}\n\n\t\tif (points[i][0] > maxX) {\n\t\t\tmaxX = points[i][0];\n\t\t}\n\n\t\tif (points[i][1] > maxY) {\n\t\t\tmaxY = points[i][1];\n\t\t}\n\t}\n\n\tctx.beginPath();\n\tctx.moveTo(points[0][0], points[0][1]);\n\tfor (let i = 1; i < points.length; i++) {\n\t\tctx.lineTo(points[i][0], points[i][1]);\n\t}\n\tctx.closePath();\n\tctx.clip();\n\n\tlet linesOffset = (maxY - minY) / Math.tan(angle);\n\n\tctx.beginPath();\n\tfor (let i = minX - linesOffset; i < maxX; i += 15) {\n\t\tctx.moveTo(i, maxY);\n\t\tctx.lineTo(i + linesOffset, minY);\n\t}\n\n\tctx.stroke();\n\tctx.restore();\n};\n\nexport default Shapes;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/ui/Shapes.js\n **/","'use strict';\n\nimport GameObject from '../GameObject';\nimport Rect from '../Rect';\n\nexport default class Sprite extends GameObject {\n\n\tconstructor(img) {\n\t\tsuper();\n\t\tthis._img = img;\n\t\tthis._width = img.width;\n\t\tthis._height = img.height;\n\t\tthis._isPressed = false;\n\t\tthis._clicked = false;\n\t}\n\n\tsetSize(widthOrFraction, height) {\n\n\t\tif (height === undefined) {\n\t\t\tlet fraction = widthOrFraction;\n\n\t\t\twidthOrFraction = this._img.width * fraction;\n\t\t\theight = this._img.height * fraction;\n\t\t}\n\t\tthis._width = widthOrFraction;\n\t\tthis._height = height;\n\t}\n\n\tupdate(fc) {\n\n\t}\n\n\tdraw(fc) {\n\t\tlet ctx = fc.graphContext;\n\n\t\tctx.save();\n\t\tctx.drawImage(this._img, 0, 0,\n\t\t\tthis._img.width, this._img.height, this._x, this._y,\n\t\t\tthis._width, this._height);\n\t\tctx.restore();\n\t}\n\n\tgetBounds() {\n\t\treturn new Rect(this._x, this._y, this._width, this._height);\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/ui/Sprite.js\n **/","'use strict';\r\n\r\n/**\r\n *\r\n * @param image the image object to use for drawing\r\n * @param frames the array describing the frames of the sprite sheet in a format:\r\n * [\r\n *     [x, y, width, height, anchorX, anchorY] // - frame 1\r\n *     [x, y, width, height, anchorX, anchorY] // - frame 2\r\n *     ...\r\n * ]\r\n */\r\n\r\nexport default class SpriteSheet {\r\n\tconstructor(image, frames) {\r\n\t\tthis._image = image;\r\n\t\tthis._frames = frames;\r\n\t}\r\n\r\n\t/**\r\n\t * Draws the frame of the sprite sheet in the given coordinates of the\r\n\t * Context.\r\n\t * @param ctx the context to draw at\r\n\t * @param index the index of the frame\r\n\t * @param x x coordinate where the anchor will appear\r\n\t * @param y y coordinate where the anchor will appear\r\n\t */\r\n\tdrawFrame(ctx, index, x, y) {\r\n\t\tlet frame = this._frames[index];\r\n\r\n\t\tif (!frame) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tctx.drawImage(this._image, frame[SpriteSheet.FRAME_X], frame[SpriteSheet.FRAME_Y],\r\n\t\t\tframe[SpriteSheet.FRAME_WIDTH], frame[SpriteSheet.FRAME_HEIGHT],\r\n\t\t\tx - frame[SpriteSheet.FRAME_ANCHOR_X], y - frame[SpriteSheet.FRAME_ANCHOR_Y],\r\n\t\t\tframe[SpriteSheet.FRAME_WIDTH], frame[SpriteSheet.FRAME_HEIGHT]);\r\n\t};\r\n}\r\n\r\nSpriteSheet.FRAME_X = 0;\r\nSpriteSheet.FRAME_Y = 1;\r\nSpriteSheet.FRAME_WIDTH = 2;\r\nSpriteSheet.FRAME_HEIGHT = 3;\r\nSpriteSheet.FRAME_ANCHOR_X = 4;\r\nSpriteSheet.FRAME_ANCHOR_Y = 5;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/ui/SpriteSheet.js\n **/","'use strict';\n\nexport default class TileSheet {\n\tconstructor(image, w, h) {\n\t\tthis._image = image;\n\t\tthis._w = w;\n\t\tthis._h = h;\n\t\tthis._row = Math.floor(image.width / w);\n\t}\n\n\tdrawTile(ctx, index, x, y) {\n\t\tif (index < 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet tx = (index % this._row) * this._w;\n\t\tlet ty = Math.floor(index / this._row) * this._h;\n\n\t\tctx.drawImage(this._image, tx, ty, this._w, this._h, x, y, this._w, this._h);\n\t};\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/ui/TileSheet.js\n **/","'use strict';\n\nimport GameObject from '../../GameObject';\n\nexport default class TileMapOrtho extends GameObject {\n\n\tconstructor(mapData, image, tileSize, viewportWidth, viewportHeight) {\n\t\tsuper();\n\t\tthis._mapData = mapData;\n\t\tthis._image = image;\n\t\tthis._tileSize = tileSize;\n\t\tthis._viewportWidth = viewportWidth;\n\t\tthis._viewportHeight = viewportHeight;\n\n\t\t// Coordinates of the map\n\t\tthis._x = 0;\n\t\tthis._y = 0;\n\n\t\t// Offscreen buffer\n\t\tthis._offCanvas = document.createElement('canvas');\n\t\tthis._offContext = this._offCanvas.getContext('2d');\n\t\tthis._offBounds = {x: 0, y: 0, w: 0, h: 0};\n\t\tthis._offDirty = true;\n\n\t\tthis._resetOffScreenCanvas();\n\n\t\t// The number of tiles in one row of the image\n\t\tthis._tilesPerRow = image.width / tileSize;\n\t}\n\n\t/* Draws the whole map */\n\tdraw(fc) {\n\t\tlet ctx = fc.graphContext;\n\n\t\tif (this._offDirty) {\n\t\t\tthis._redrawOffscreen();\n\t\t}\n\n\t\tlet offCanvasX = -Math.floor(this._x) - this._offBounds.x * this._tileSize;\n\t\tlet offCanvasY = -Math.floor(this._y) - this._offBounds.y * this._tileSize;\n\t\tlet offCanvasW = Math.min(this._offCanvas.width - offCanvasX, this._viewportWidth);\n\t\tlet offCanvasH = Math.min(this._offCanvas.height - offCanvasY, this._viewportHeight);\n\n\t\tctx.drawImage(this._offCanvas, offCanvasX, offCanvasY, offCanvasW, offCanvasH,\n\t\t\t0, 0, offCanvasW, offCanvasH);\n\t}\n\n\tmove(deltaX, deltaY) {\n\t\tthis._x += deltaX;\n\t\tthis._y += deltaY;\n\t\tthis._updateOffscreenBounds();\n\t}\n\n\tsetViewportSize(width, height) {\n\t\tthis._viewportWidth = width;\n\t\tthis._viewportHeight = height;\n\t\tthis._resetOffScreenCanvas();\n\t}\n\n\t_resetOffScreenCanvas() {\n\t\tthis._updateOffscreenBounds();\n\t\tthis._offCanvas.width = this._offBounds.w * this._tileSize;\n\t\tthis._offCanvas.height = this._offBounds.h * this._tileSize;\n\t\tthis._offDirty = true;\n\t}\n\n\t_redrawOffscreen() {\n\t\tlet ctx = this._offContext;\n\n\t\tctx.clearRect(0, 0, this._offCanvas.width, this._offCanvas.height);\n\n\t\tlet startX = Math.max(this._offBounds.x, 0);\n\t\tlet endX = Math.min(startX + this._offBounds.w - 1, this._mapData[0].length - 1);\n\n\t\tlet startY = Math.max(this._offBounds.y, 0);\n\t\tlet endY = Math.min(startY + this._offBounds.h - 1, this._mapData.length - 1);\n\n\t\tfor (let cellY = startY; cellY <= endY; cellY++) {\n\t\t\tfor (let cellX = startX; cellX <= endX; cellX++) {\n\t\t\t\tlet tileId = this._mapData[cellY][cellX];\n\n\t\t\t\tthis._drawTileAt(ctx, tileId, cellX, cellY);\n\t\t\t}\n\t\t}\n\t\tthis._offDirty = false;\n\t}\n\n\t_drawTileAt(ctx, tileId, cellX, cellY) {\n\n\t\t// Position of the tile inside of a tile sheet\n\t\tlet srcX = (tileId % this._tilesPerRow) * this._tileSize;\n\t\tlet srcY = Math.floor(tileId / this._tilesPerRow) * this._tileSize;\n\n\t\t// size of the tile\n\t\tlet size = this._tileSize;\n\n\t\t// position of the tile on the offscreen buffer\n\t\tlet destX = (cellX - this._offBounds.x) * size;\n\t\tlet destY = (cellY - this._offBounds.y) * size;\n\n\t\tctx.drawImage(this._image, srcX, srcY, size, size, destX, destY, size, size);\n\t}\n\n\t_updateOffscreenBounds() {\n\t\tlet oldBounds = this._offBounds;\n\n\t\tlet newBounds = {\n\t\t\tx: Math.floor(-this._x / this._tileSize),\n\t\t\ty: Math.floor(-this._y / this._tileSize),\n\t\t\tw: Math.ceil(this._viewportWidth / this._tileSize) + 1,\n\t\t\th: Math.ceil(this._viewportHeight / this._tileSize) + 1\n\t\t};\n\n\t\tif (!(oldBounds.x === newBounds.x &&\n\t\t\toldBounds.y === newBounds.y &&\n\t\t\toldBounds.w === newBounds.w &&\n\t\t\toldBounds.h === newBounds.h)) {\n\n\t\t\tthis._offBounds = newBounds;\n\t\t\tthis._offDirty = true;\n\t\t}\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/ui/map/TileMapOrtho.js\n **/"],"sourceRoot":""}